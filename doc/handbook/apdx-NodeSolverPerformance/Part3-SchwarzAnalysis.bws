restart
**************

  Database Explorer v2
  ____________________

Databases loaded:
List of 0 instances of IDatabaseInfo {
}
Setting Matlab Connector to Octave...

 Console ready for input. Type 'help' for help.

==============
WorkflowMgm.Init("PoissonSolverPerformance");
**************
Project name is set to 'PoissonSolverPerformance'.

==============
using System.IO;
using BoSSS.Application.SipPoisson;
**************
==============
string dateString = "2018-2-10";
string File       = "SolverRuns--" + dateString + ".json";
string FilePath   = Path.Combine(CurrentDocDir, File);
var SessTab       = TableExtensions.LoadFromFile(FilePath);
**************
==============
//SessTab.Print();
**************
==============
((int) SolverCodes.exp_softpcg_schwarz_directcoarse);
**************
6
==============
((int) SolverCodes.exp_softpcg_mg);
**************
4
==============
// ====================
// Evaluation, plotting
// ====================
**************
==============
SessTab.GetColumnNames();
**************
List of 48 instances of String {
  0: SessionName
  1: DGdegree:T
  2: DGdegree:Tex
  3: Bndtype:Dirichlet
  4: Bndtype:Neumann
  5: GeneratedFromCode
  6: ControlFileText_Index
  7: dtFixed
  8: NoOfMultigridLevels
  9: penalty_poisson
  10: solver_name
  11: NoOfSolverRuns
  12: ExactSolution_provided
  13: GridPartType
  14: ProjectName
  15: NoOfTimesteps
  16: Endtime
  17: saveperiod
  18: dtMin
  19: dtMax
  20: CompMode
  21: ImmediatePlotPeriod
  22: SuperSampling
  23: savetodb
  24: logFileDirectory
  25: Paramstudy_ContinueOnError
  26: DynamicLoadBalancing_RedistributeAtStartup
  27: DynamicLoadBalancing_Period
  28: DynamicLoadBalancing_ImbalanceThreshold
  29: AdaptiveMeshRefinement
  30: CutCellQuadratureType
  31: ContinueOnIoError
  32: Grid:NoOfCells
  33: Grid:hMax
  34: Grid:hMin
  35: UsedNoOfMultigridLevels
  36: minSolRunT
  37: maxSolRunT
  38: Conv
  39: NoIter
  40: NoOfCells
  41: DOFs
  42: BlockSize
  43: RegularTerminated
  44: SipMatrixAssembly_time
  45: Aggregation_basis_init_time
  46: Solver_Init_time
  47: Solver_Run_time
}
==============
//var SubTab_1 = SessTab.ExtractColumns("DGdegree:T", "Grid:NoOfCells", "solver_name", "DOFs", "minSolRunT", "maxSolRunT", "NoIter", "RegularTerminated", "Conv");
**************
==============
var SubTab_1 = SessTab.ExtractRows(delegate(int i, IDictionary<string,object> row) {
    return (  (Convert.ToInt32(row["solver_name"]) ==  ((int) SolverCodes.exp_softpcg_schwarz_directcoarse))
          || (Convert.ToInt32(row["solver_name"]) ==  ((int) SolverCodes.exp_softpcg_schwarz))
          || (Convert.ToInt32(row["solver_name"]) ==  ((int) SolverCodes.exp_softpcg_mg)))
          && (Convert.ToInt32(row["Conv"]) != 0);
    });
**************
==============
var SubTab = SubTab_1.ExtractColumns("DGdegree:T", "Grid:NoOfCells", "solver_name", "DOFs", 
              "minSolRunT", "maxSolRunT", "UsedNoOfMultigridLevels",
              "SipMatrixAssembly_time", "Aggregation_basis_init_time", "Solver_Init_time", "Solver_Run_time");
**************
==============
SubTab.Print();
**************
    DGdegree:T Grid:NoOfCells solver_name DOFs   minSolRunT  maxSolRunT  UsedNoOfMultigridLevels SipMatrixAssembly_time Aggregation_basis_init_time Solver_Init_time Solver_Run_time 
0:  3          20480          4           409600 421.6741997 422.5177228 17                      18.7681991             700.9967411                 35.43172775      386.62792745    
1:  3          2560           4           51200  37.9708965  39.885677   13                      2.9498911              61.7016825                  4.0008148        34.907579       
2:  3          320            4           6400   5.4027531   5.7121607   10                      0.9056809              5.7735466                   0.60705695       4.9323502       
3:  3          40             4           800    0.2284069   0.5570804   7                       0.5905805              0.508937                    0.09434835       0.2816406       
4:  2          20480          4           204800 148.3721679 153.2123022 17                      6.8393303              572.5032557                 14.88305495      135.88196125    
5:  2          2560           4           25600  16.301376   16.8450085  13                      1.3462241              47.0030984                  1.70188615       14.8525236      
6:  2          320            4           3200   1.9368268   2.2983545   10                      0.6940239              4.3053677                   0.25104215       1.84973075      
7:  2          40             4           400    0.1205641   0.4586133   7                       0.6255514              0.3895446                   0.07440095       0.19780185      
8:  3          20480          6           409600 390.3218718 393.5016035 17                      17.7667034             669.5929173                 63.21979115      328.65436955    
9:  3          2560           6           51200  27.210639   27.6054704  13                      2.7357368              56.3735972                  7.78967205       19.60290185     
10: 3          320            6           6400   4.707644    5.2670534   10                      0.8089003              5.1424521                   1.1017856        3.87265025      
11: 3          40             6           800    2.5469665   2.8956922   7                       0.5618062              0.4292369                   0.3244349        2.3841398       
12: 2          20480          6           204800 94.6536695  94.7905943  17                      6.4902633              545.7509009                 17.28302395      77.41473495     
13: 2          2560           6           25600  9.6737434   9.8025789   13                      1.4462802              48.617592                   2.3691387        7.3557623       
14: 2          320            6           3200   3.061871    3.525212    10                      0.6250326              4.1457639                   0.45723825       2.8248578       
15: 2          40             6           400    2.4709977   2.8666587   7                       0.5400817              0.3679988                   0.2583267        2.3991332       
16: 2          2560           5           25600  749.3842617 750.960602  3                       1.3581869              5.6785293                   21.3580158       728.80093615    
17: 2          320            5           3200   39.0187606  39.0274362  3                       0.6901283              0.7779678                   1.06727205       37.94337105     
18: 2          40             5           400    1.4043004   1.9798036   3                       0.5587462              0.1304635                   0.20593605       1.47307745      
==============
**************
==============
**************
==============
**************
==============
var Solvers = new SolverCodes[] {
SolverCodes.exp_softpcg_schwarz_directcoarse,
SolverCodes.exp_softpcg_mg
};
**************
==============
//cl.WriteMinimalCompileableExample("C:\\tmp\\mini.tex");
**************
==============
**************
==============
Plot2Ddata[][,] AllMultiplots = new Plot2Ddata[2][,];
for(int iPlot = 0; iPlot < AllMultiplots.Length; iPlot++) {
Plot2Ddata[,] multiplots = new Plot2Ddata[2,1];
AllMultiplots[iPlot] = multiplots;
int pDegree = 2;
for(int iRow = 0; iRow < 2; iRow++) {
 
    multiplots[iRow,0] = SubTab.ToPlot(
       delegate (int iSweep, int iTabRow, 
                 IDictionary<string, object> Row, 
                 out string Nmn, 
                 out PlotFormat Fmt,
                 out double xValue, out double yValue) { 
           // - - - - - - - - - - - - - - - - - - - - - - - - 
           // PlotRowSelector:
           // selects, which table row goes to which graph,
           // and the respective color  
           // - - - - - - - - - - - - - - - - - - - - - - - - 
           int k = Convert.ToInt32(Row["DGdegree:T"]);
           SolverCodes solver_name = (SolverCodes) Convert.ToInt32(Row["solver_name"]);
           
           if(    k != pDegree 
               || solver_name != Solvers[iPlot]) {
                // degree does not match -> not in this plot
                Nmn    = null;
                Fmt    = null;
                xValue = 0;
                yValue = 0;
                return;
           }
           
           double mtxAssi  = Convert.ToDouble(Row["SipMatrixAssembly_time"]);
           double aggBinit = Convert.ToDouble(Row["Aggregation_basis_init_time"]);
           double slvInit  = Convert.ToDouble(Row["Solver_Init_time"]);
           double slvRun   = Convert.ToDouble(Row["Solver_Run_time"]);
           double dofs     = Convert.ToDouble(Row["DOFs"]);
           
           if(aggBinit > 700)
           Console.Write("aggBinit/slvRun = " + aggBinit + "/" + slvRun);
           
           Fmt           = new PlotFormat();
           Fmt.PointSize = 0.5;
           Fmt.Style     = Styles.LinesPoints;
           Fmt.LineColor = LineColors.Black;
           Fmt.LineWidth = 2;
           
           xValue = dofs;
           
           switch(iSweep) {
               case 0:
               yValue       = slvRun;
               Nmn          = "Slv Iter";
               Fmt.DashType = DashTypes.Dotted;
               Fmt.PointType = PointTypes.OpenCircle;
               break;
               
               case 1:
               yValue        = slvInit;
               Nmn           = "Slv Init";
               Fmt.DashType  = DashTypes.Dashed;
               Fmt.PointType = PointTypes.OpenBox;
               break;
               
               case 2:
               yValue        = aggBinit;
               Nmn           = "Agg Init";
               Fmt.DashType  = DashTypes.DotDashed;
               Fmt.PointType = PointTypes.OpenDiamond;
               break;
               
               case 3:
               yValue        = mtxAssi;
               Nmn           = "Mtx ass";
               Fmt.DashType  = DashTypes.DotDotDashed;
               Fmt.PointType = PointTypes.OpenUpperTriangle;
               break;
               
               default:
               throw new NotImplementedException();
           }
           
           if(aggBinit > 700)
           Console.WriteLine("\t + case: {0} + yValue = {1}", iSweep, yValue);
       },
       4 // 4 sweeps over table
       );
 
    string Title = string.Format("$k = {0}$", pDegree);
    multiplots[iRow,0].Ylabel = Title;
    multiplots[iRow,0].LogX = true;
    multiplots[iRow,0].LogY = true;
 
    multiplots[iRow,0].YrangeMin = 1;
    multiplots[iRow,0].YrangeMax = 1e+4;
    //multiplots[iRow,iCol].XrangeMin = 1e2;
    //multiplots[iRow,iCol].XrangeMax = 1e7;
    //multiplots[iRow,iCol].Y2rangeMin = 1e-3;
    //multiplots[iRow,iCol].Y2rangeMax = 1e+4;
    //multiplots[iRow,iCol].X2rangeMin = 1e2;
    //multiplots[iRow,iCol].X2rangeMax = 1e7;
 
    //if(iRow == 2) {
    //    multiplots[iRow,iCol].ShowLegend = true;
    //    multiplots[iRow,iCol].LegendPosition = new double[] {1e12,1e4};
    //} else {
    //    multiplots[iRow,iCol].ShowLegend = false;
    //}
 
    //if(iCol == 1) {
    //    multiplots[iRow,iCol].SwapYaxes();
    //    multiplots[iRow,iCol].lmargin = 1;
    //    multiplots[iRow,iCol].rmargin = 10;
    //} else {
    //    multiplots[iRow,iCol].lmargin = 10;
    //    multiplots[iRow,iCol].rmargin = 1;
    //}
    //multiplots[iRow,iCol].tmargin = 1;
    //multiplots[iRow,iCol].bmargin = 1;
    
    pDegree++;                       
}
}
**************
aggBinit/slvRun = 700.9967411/386.62792745	 + case: 0 + yValue = 386.62792745
aggBinit/slvRun = 700.9967411/386.62792745	 + case: 1 + yValue = 35.43172775
aggBinit/slvRun = 700.9967411/386.62792745	 + case: 2 + yValue = 700.9967411
aggBinit/slvRun = 700.9967411/386.62792745	 + case: 3 + yValue = 18.7681991

==============
var CL = AllMultiplots[0].ToGnuplot().PlotCairolatex(xSize:16, ySize:12);
CL.PlotNow();
**************
Using gnuplot: C:\Program Files (x86)\FDY\BoSSS\bin\native\win\gnuplot-gp510-20160418-win32-mingw\gnuplot\bin\gnuplot.exe
System.Drawing.Bitmap
==============
CL.SaveTo(Path.Combine(CurrentDocDir, "ConstCoeffPoisson_Schwarz.tex"));
**************
==============
CL.WriteMinimalCompileableExample("C:\\tmp\\Schwarz" + dateString + ".tex");
**************
==============
**************
==============
**************
==============
var CL = AllMultiplots[1].ToGnuplot().PlotCairolatex(xSize:16, ySize:12);
CL.PlotNow();
**************
Using gnuplot: C:\Program Files (x86)\FDY\BoSSS\bin\native\win\gnuplot-gp510-20160418-win32-mingw\gnuplot\bin\gnuplot.exe
System.Drawing.Bitmap
==============
CL.SaveTo(Path.Combine(CurrentDocDir, "ConstCoeffPoisson_MG.tex"));
**************
==============
CL.WriteMinimalCompileableExample("C:\\tmp\\MG" + dateString + ".tex");
**************
==============
**************
==============
**************
==============
**************
==============
**************
==============
**************
==============
