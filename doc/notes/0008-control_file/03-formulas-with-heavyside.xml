<?xml version="1.0" encoding="utf-8"?>
<BoSSSControl>
    <Base>
        <dboptions path="C:\BoSSS\bosss_db"/>
        <grid guid="fb1d767f-d056-4249-939a-3b67016a94fd"/>
        
        <description name="control file example">
            control file example
        </description>
        <tags>
            control example
        </tags>
        <run mode="solver"/> 
        <fields_degree>
            <field identification="u" degree="2"/>
            <field identification="v" degree="2"/>
            <field identification="Phi" degree="2"/>
        </fields_degree>
    </Base>
    
    <initial mode="values">
        <values>
            <!-- Functions with kinks or discontinuities can be entered using
            the "jump" function which models a heavyside function
            Note: This also works for boundary conditions -->
            <formula>
                <!-- u(x,y) = 0.0 if x < 1.0 and u(x,y) = 1.0 otherwise -->
                u(x,y) = jump(x - 1.0)
            </formula>
            <formula field="v">
                <!-- v(x,y) = 1.0 if -1.0 <= x < 1.0 and v(x,y) = 0.0 otherwise -->
                v(x,y) = jump(x + 1.0) - jump(x - 1.0)
            </formula>
            <formula>
                <!-- Phi is ramp function (with kinks): Phi = 0.0 if x < 0.0;
                Phi = x if 0.0 <= x < 1.0 and Phi = 1 if x >= 1.0 -->
                Phi(x,y) = (jump(x) - jump(x - 1.0)) * x + jump(x - 1.0)
            </formula>
        </values>    
    </initial>
    
    <Solver>
        <logging savetodb="true" saveperiod="5" tracing="true"/>
        <termcond NoOfTimesteps="5" Endtime="50"/>
        <timestepping dtMin="0.0" dtMax="0.2" CFLFrac = "0.3"/>
  
        <boundary>
            <bc edgetagname="velocity_inlet">
                <formula>
                    u(x,y)=1-y*y
                </formula>
            </bc>
            <bc edgetagname="wall">
            </bc>
            <bc edgetagname="pressure_outlet">
                <value field="pressure">0.0</value>
            </bc>
        </boundary>
        <properties>
            <float key="Reynolds">10.0</float>
            <float key="penalty_poisson">2.5</float>
            <float key="penalty_viscous">1.5</float>
            <string key="pressure_solver">iterative-pressure-solver</string>
            <string key="viscous_solver">iterative-viscous-solver</string>
            <fvector key="PoissonRefPt">5.0 0.0</fvector>
            <string key="method:major-opt">projection</string>
            <string key="method:minor-opt">lie</string>
            <string key="bc-and-fluxes">kummers-method</string>
            <float key="CrankNic:theta">1.0</float>
            <string key="IOFields">pri_Velocity IntVelocity pri_Phi DivB4 DivAfter </string>
            <string key="ResFields">pri_Velocity pri_Phi DivB4 DivAfter </string>
        </properties>
    </Solver>

    <sparsesolver name="iterative-pressure-solver">
        <type>PCG</type>
        <library>HYPRE</library>
        <MaxIterations>1000000</MaxIterations>
        <ConvergenceType>Relative</ConvergenceType>
        <Tolerance>1.0e-9</Tolerance>
        <specific>
            <RelChange>5</RelChange>
            <TwoNorm>true</TwoNorm>
        </specific>
    </sparsesolver>

    <sparsesolver name="iterative-viscous-solver">
        <type>PCG</type>
        <library>HYPRE</library>
        <MaxIterations>8000</MaxIterations>
        <ConvergenceType>Relative</ConvergenceType>
        <Tolerance>1.0e-12</Tolerance>
        <specific>
            <RelChange>5</RelChange>
            <TwoNorm>true</TwoNorm>
        </specific>
    </sparsesolver>
</BoSSSControl>