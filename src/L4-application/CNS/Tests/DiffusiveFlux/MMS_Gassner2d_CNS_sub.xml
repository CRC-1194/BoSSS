<?xml version="1.0" encoding="utf-8"?>
<!--  BoSSS control file, specialized for the compressible Navier-Stokes solver: 
      Source Terms for a manufactured solution based on: "Gassner, Gregor, 
      Frieder Lörcher, and C-D. Munz. "A discontinuous Galerkin scheme 
      based on a space-time expansion II. Viscous flow equations in multi 
      dimensions." Journal of Scientific Computing 34.3 (2008): 260-286."-->
<BoSSSControl>
	<Base>
		<dboptions path="c:\bosss_dbv2\Gassner2d_CNS\" />
		<!-- no grid-->
    <grid guid="00000000-0000-0000-0000-000000000008" />

    <description name="Gassner2d_CNS_Re=1_mu=1_BC=dirichlet_h=1/8_p=1_test">
			viscous NSE Test -> MMS 2D
		</description>
		
		<tags>
			viscous, NSE, MMS
		</tags>
    <!-- Specify "solver" or "query" or "parameterStudy" -->
		<run mode="solver"/>
    
		<fields_degree>
			<!-- Specify DG polynomial degree; If degree for "u", "e", "p",
								"T", "Ma", "K" or "S" are given, these fields will also be
								calculated and included in IO operations -->
			<field	identification="rho"	degree="1" />
			<field	identification="m"		degree="1" />
			<field	identification="rhoE"	degree="1" />
      <field  identification="u" degree="1"/>
      <field  identification="p" degree="1"/>
      <field  identification="Ma" degree="1"/>
		</fields_degree>
	</Base>

	<!-- Specify "values" or "restart" -->
	<initial mode="values">

		<restart>
			<session guid="969eb288-1c19-4cbc-bdf7-f8edc8d8da3b" timestepno="" />
		</restart>

		<values>
			<formula>
        rho(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))
      </formula>
			<formula>
        m0(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))
      </formula>
      <formula>
        m1(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))
      </formula>
			<formula>
        rhoE(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))*(2.0 + 0.5*sin(2*PI*(x+y)))
      </formula>
		</values>
	</initial>

	<Solver>
		<logging savetodb="true" saveperiod="1000" tracing="false"/>
		<termcond Endtime="30.0" NoOfTimesteps="200000000"/>
		<timestepping dtMin="0.0e-3" dtMax="5.0e-2" CFLFrac="0.1"/>
		<!--<timestepping dtMin="4.82e-6" dtMax="4.82e-6" CFLFrac="0.01"/>-->

		<boundary>
			<bc edgetagname="supersonicinlet">
				<formula>
          rho(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))
        </formula>
				<formula>
          u0(x,y) = 1.0
        </formula>
        <formula>
          u1(x,y) = 1.0
        </formula>
				<formula>
          p(x,y) = (1.4-1)*((2.0 + 0.5*sin(2*PI*(x+y)))*(2.0 + 0.5*sin(2*PI*(x+y)))-(2.0 + 0.5*sin(2*PI*(x+y))))
        </formula>
			</bc>
      <bc edgetagname="subsonicinlet">
        <formula>
          rho(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))
        </formula>
        <formula>
          u0(x,y) = 1.0
        </formula>
        <formula>
          u1(x,y) = 1.0
        </formula>
      </bc>
			<bc edgetagname="subsonicoutlet">
        <formula>
          p(x,y) = (1.4-1)*((2.0 + 0.5*sin(2*PI*(x+y)))*(2.0 + 0.5*sin(2*PI*(x+y)))-(2.0 + 0.5*sin(2*PI*(x+y))))
        </formula>
			</bc>

		</boundary>
		<properties>
		
			<string key="equationSystem">NavierStokes</string>
			<string key="convectiveFluxType">HLLC</string>
			
			<string key="diffusiveFluxType">SIPG</string>			
			<float key="SIPGPenaltyConstant">1.3</float> 

			<string key="timeStepping">explicit</string>
			<string key="explicitScheme">RungeKutta</string>
        <int key="explicitOrder">1</int>

      <!--<float key="Reynolds">5.5613479</float>-->
      <float key="Reynolds">1.0</float>
			<float key="Mach">1.0</float>
			<float key="Prandtl">0.72</float>
			<float key="kappa">1.4</float>
			<!-- Choose "IdealGas", "Tait" or "StiffenedGas". Omitting this
								 option will make CNS default to "IdealGas".-->
			<string key="equationOfState">IdealGas</string>
			<!-- "None": No residual calculation;
								 "SteadyState": Residuals for a steady state problem;
								 "Unsteady": Residuals for an unsteady problem -->
			<string key="residualType">ChangeRate,query</string>
			<int key="residualInterval">100</int>
      <!-- Interval for 'Starting time step' statements (they can affect
                 serial and parallel performance of individual time-steps are
                 fast!). -->
      <int key="printInterval">100</int>
			<!-- The following properties represent optional formulas defining 
								 source terms of the selected equation system. Each formula may
								 depend on independent variables as well as primal fields -->
			<string key="rhoSource">
        f(x,y)  = -0.5*4*PI*cos(2*PI*(x+y))
      </string>
			<string key="m0Source">
        f(x,y)  = -(6*1.4-2)*0.5*PI*cos(2*PI*(x+y))
        -0.5*0.5*(1.4-1)*2*PI*sin(4*PI*(x+y))
      </string>
      <string key="m1Source">
        f(x,y)  = -(6*1.4-2)*0.5*PI*cos(2*PI*(x+y))
        -0.5*0.5*(1.4-1)*2*PI*sin(4*PI*(x+y))
      </string>
			<string key="rhoESource">
        f(x,y) =  -cos(2*PI*(x+y))*(6*1.4+2)*0.5*2*PI
        -0.5*0.5*4*1.4*PI*sin(4*PI*(x+y))
        -0.5*8*PI*PI*1.4/(0.72*1000)*sin(2*PI*(x+y))
      </string>
			<!-- Choose "Symbolic" or "byFlux" for the calculation of the
								 derivatives of the primal variables -->
			<string key="derivativeOption">None</string>
		</properties>

   
    <Queries>
			<L2Error id="SolL2Err_rho">
				<computedSolution>
					<field identification="rho" />
				</computedSolution>
				<exactSolution>
          <formula degree="10">
            rho(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))
          </formula>
				</exactSolution>
			</L2Error>
      <L2Error id="SolL2Err_m0">
        <computedSolution>
          <field identification="m0" />
        </computedSolution>
        <exactSolution>
          <formula degree="10">
            m0(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))
          </formula>
        </exactSolution>
      </L2Error>
      <L2Error id="SolL2Err_rhoE">
        <computedSolution>
          <field identification="rhoE" />
        </computedSolution>
        <exactSolution>
          <formula degree="10">
            rhoE(x,y) = (2.0 + 0.5*sin(2*PI*(x+y)))*(2.0 + 0.5*sin(2*PI*(x+y)))
          </formula>
        </exactSolution>
      </L2Error>
      <L2Error id="SolL2Err_U0">
        <computedSolution>
          <field identification="u0" />
        </computedSolution>
        <exactSolution>
          <formula degree="10">
            u0(x) = 1.0
          </formula>
        </exactSolution>
      </L2Error>
		</Queries>
	</Solver>
  <ParameterStudy logFileDirectory=".">
    <parameterSet>
      <parameter id="grid" xpath="Base/grid/@guid">
        00000000-0000-0000-0000-000000000008
        00000000-0000-0000-0000-000000000016
        00000000-0000-0000-0000-000000000032
      </parameter>
      <parameter id="description" xpath="Base/description/@name">
        Gassner2d_CNS-subsonic_h=1/8_p=4
        Gassner2d_CNS-subsonic_h=1/16_p=4
        Gassner2d_CNS-subsonic_h=1/32_p=4
      </parameter>
    </parameterSet>
    <parameterSet>
      <parameter id="rho-degree" xpath="Base/fields_degree/field[@identification='rho']/@degree">4</parameter>
      <parameter id="m-degree" xpath="Base/fields_degree/field[@identification='m']/@degree">4</parameter>
      <parameter id="rhoE-degree" xpath="Base/fields_degree/field[@identification='rhoE']/@degree">4</parameter>
      <parameter id="u-degree" xpath="Base/fields_degree/field[@identification='u']/@degree">4</parameter>
    </parameterSet>
  </ParameterStudy>

</BoSSSControl>
